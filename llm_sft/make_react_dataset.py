# make_react_dataset.py
# ReAct Planner SFT용 학습 데이터 자동 생성 (약 80개 샘플)
#
# 출력: react_sft_data.jsonl
# 각 라인: {"prompt": "...", "response": "Thought: ...\nAction: ...\nAction Input: ..."}

import json
from pathlib import Path

# ---------------------------------------------------------
# 1) 공통 프롬프트 템플릿
#   - 실제 agent_llm_node 프롬프트의 축약/정리 버전
#   - TAG 형식과 도구 이름, 사용 규칙을 명확하게 박아 넣어서 학습
# ---------------------------------------------------------

BASE_PROMPT_TEMPLATE = """당신은 도구를 사용할 수 있는 한국어 지능형 에이전트입니다.

사용 가능한 도구:
- web_search : 웹 검색을 통해 최신 정보, 일반 상식, 생활 정보를 찾습니다.
- doc_search : 내부 문서(AI 개념, 자연어 처리, 강화학습 등)를 검색합니다.
- summarize  : 여러 정보를 요약하여 정리합니다.
- FINAL      : 지금까지의 정보를 바탕으로 최종 답변을 바로 제공합니다.

⚠ 매우 중요 (형식 규칙)
- 반드시 아래 TAG 를 영어 그대로 사용해야 합니다.
  Thought:
  Action:
  Action Input:
- 도구 이름도 반드시 다음 중 하나만, 철자 그대로 사용해야 합니다.
  web_search / doc_search / summarize / FINAL

출력 형식(반드시 이 3줄만 최상위에 포함):

Thought: (짧은 생각, 왜 이 도구를 선택하는지)
Action: web_search | doc_search | summarize | FINAL
Action Input: (선택한 도구에 넘길 입력 내용, FINAL이면 최종 답변 전체)

지금까지의 대화 및 도구 결과:
{history_block}

사용자의 질문:
{user_query}

위 형식을 따라 다음 행동을 결정하세요.
"""

# ---------------------------------------------------------
# 2) 샘플 생성 헬퍼 함수
# ---------------------------------------------------------

def make_sample(history_block: str, user_query: str,
                thought: str, action: str, action_input: str):
    """
    하나의 SFT 샘플(dict)을 만들어준다.
    - prompt: BASE_PROMPT_TEMPLATE 에 history_block / user_query 삽입
    - response: Thought/Action/Action Input 세 줄만 포함
    """
    prompt = BASE_PROMPT_TEMPLATE.format(
        history_block=history_block,
        user_query=user_query,
    )

    # Action 은 반드시 web_search / doc_search / summarize / FINAL 중 하나로 통일
    response = f"Thought: {thought}\nAction: {action}\nAction Input: {action_input}"

    return {"prompt": prompt, "response": response}


# ---------------------------------------------------------
# 3) 실제 데이터셋 구성
#    - web_search 중심 샘플
#    - doc_search 중심 샘플
#    - summarize (Observation 기반 요약)
#    - FINAL (도구 없이 답변)
# ---------------------------------------------------------

def build_dataset():
    samples = []

    # -----------------------------
    # A. web_search 샘플들 (약 20개)
    #  - "최신", "2025년", "동향", "시장", "정책" 등 → 항상 web_search
    # -----------------------------
    web_cases = [
        (
            "없음",
            "2025년 기준 자율주행 자동차의 최신 동향을 알려줘",
            "자율주행 자동차 최신 동향은 빠르게 변하므로 최신 정보를 얻기 위해 웹 검색이 필요하다.",
            "web_search",
            "2025년 기준 자율주행 자동차 최신 기술 및 시장 동향"
        ),
        (
            "없음",
            "2025년 인공지능 산업의 주요 트렌드를 알려줘",
            "2025년 AI 산업 동향은 실시간으로 변화하므로, 웹 검색을 통해 최신 정보를 수집하는 것이 적절하다.",
            "web_search",
            "2025년 인공지능 산업 주요 트렌드와 시장 전망"
        ),
        (
            "없음",
            "최근 LLM 관련 보안 이슈가 뭐가 있었는지 알려줘",
            "보안 이슈는 시의성이 매우 중요하므로, 최신 뉴스를 파악하기 위해 웹 검색을 해야 한다.",
            "web_search",
            "최근 대형 언어 모델(LLM) 관련 보안 사고와 이슈"
        ),
        (
            "없음",
            "2025년 한국 스타트업 투자 동향을 알고 싶어",
            "투자 동향은 매년 크게 변하므로 최신 데이터를 위해 웹 검색을 사용하는 것이 바람직하다.",
            "web_search",
            "2025년 한국 스타트업 투자 동향 및 주요 업종"
        ),
        (
            "없음",
            "클라우드 시장의 최근 점유율 변화를 알려줘",
            "클라우드 시장 점유율은 최신 통계 자료가 필요하므로, 웹 검색으로 정보를 수집해야 한다.",
            "web_search",
            "최근 글로벌 클라우드 시장 점유율 변화 추세"
        ),
        (
            "없음",
            "테슬라의 2025년 신차 계획이 있는지 궁금해",
            "특정 기업의 신차 계획은 공식 발표나 뉴스 기사에서 확인해야 하므로 웹 검색이 필요하다.",
            "web_search",
            "테슬라 2025년 신차 출시 계획 및 발표 내용"
        ),
        (
            "없음",
            "2025년 한국 정부의 AI 규제 정책을 정리해줘",
            "정부 정책은 자주 개정되기 때문에, 최신 AI 규제 관련 내용을 웹에서 확인해야 한다.",
            "web_search",
            "2025년 한국 정부 AI 규제 정책 및 법안 정리"
        ),
        (
            "없음",
            "요즘 가장 많이 쓰이는 머신러닝 프레임워크가 뭐야?",
            "프레임워크 사용 트렌드는 커뮤니티와 통계 자료를 통해 확인해야 하므로, 웹 검색을 사용하는 것이 좋다.",
            "web_search",
            "최근 인기 머신러닝/딥러닝 프레임워크 순위와 사용 비율"
        ),
        (
            "없음",
            "2025년 기준으로 GPU 가격 동향이 어떤지 알려줘",
            "GPU 가격은 시장 상황에 따라 크게 변하므로, 최신 가격 동향을 웹 검색으로 파악해야 한다.",
            "web_search",
            "2025년 GPU 가격 동향 및 수급 상황"
        ),
        (
            "없음",
            "2025년 기준 원격 근무 트렌드가 어떤지 궁금해",
            "원격 근무 트렌드는 사회·기업 정책 변화에 따라 달라지므로 웹 검색이 적절하다.",
            "web_search",
            "2025년 전세계 원격 근무 트렌드와 기업 사례"
        ),
        (
            "없음",
            "최근 LLM 기반 검색 서비스의 경쟁 구도가 궁금해",
            "LLM 기반 검색 서비스는 빠르게 발전하고 있으므로, 최신 경쟁 구도를 웹 검색으로 파악해야 한다.",
            "web_search",
            "LLM 기반 검색 서비스 최근 경쟁 구도와 주요 플레이어"
        ),
        (
            "없음",
            "2025년 한국 대기업들의 AI 투자 전략을 정리해줘",
            "대기업 AI 투자 전략은 기사와 리포트를 통해 확인하는 것이 좋으므로 웹 검색이 필요하다.",
            "web_search",
            "2025년 한국 주요 대기업 AI 투자 전략 및 사례"
        ),
        (
            "없음",
            "최근 공개된 유명 오픈소스 LLM 프로젝트를 알려줘",
            "오픈소스 LLM 프로젝트는 GitHub 등에서 수시로 공개되므로 웹 검색으로 확인해야 한다.",
            "web_search",
            "최근 공개된 주요 오픈소스 LLM 프로젝트 목록"
        ),
        (
            "없음",
            "2025년 국내 데이터센터 전력 사용 문제에 대해 정리해줘",
            "데이터센터 전력 사용 이슈는 기사와 리포트가 많으므로 웹 검색으로 최신 상황을 파악하는 것이 좋다.",
            "web_search",
            "2025년 국내 데이터센터 전력 사용 및 규제 동향"
        ),
        (
            "없음",
            "2025년 챗봇 서비스 상용화 사례를 몇 가지 알려줘",
            "챗봇 상용화 사례는 기업별로 다르기 때문에 웹 검색으로 실제 사례를 찾아야 한다.",
            "web_search",
            "2025년 기준 챗봇 상용화 사례 및 도입 효과"
        ),
        (
            "없음",
            "최근 생성형 AI를 규제하려는 움직임이 어떤지 알고 싶어",
            "생성형 AI 규제 움직임은 각국 정부와 기관의 최근 발표를 확인해야 하므로 웹 검색이 필요하다.",
            "web_search",
            "최근 생성형 AI 규제 논의 및 법제화 동향"
        ),
        (
            "없음",
            "2025년 기준 한국 개발자 연봉 트렌드를 알려줘",
            "연봉 트렌드는 통계 사이트와 리포트를 확인해야 하므로 웹 검색이 적합하다.",
            "web_search",
            "2025년 한국 개발자 연봉 동향 및 직무별 평균"
        ),
        (
            "없음",
            "한국에서 인기 있는 클라우드 자격증이 뭐가 있는지 알려줘",
            "자격증 인기도는 시간이 지나며 변하므로 웹 검색으로 최신 정보를 확인하는 것이 바람직하다.",
            "web_search",
            "한국에서 인기 있는 클라우드 관련 자격증 종류와 특징"
        ),
        (
            "없음",
            "2025년에 주목받는 데이터 분석 직무가 뭐야?",
            "직무 트렌드는 채용 동향과 산업 리포트를 통해 확인해야 하므로 웹 검색을 사용해야 한다.",
            "web_search",
            "2025년 주요 데이터 분석 직무와 요구 역량"
        ),
        (
            "없음",
            "요즘 가장 주목받는 AI 스타트업 사례를 알려줘",
            "AI 스타트업 사례는 빠르게 변하므로 최신 뉴스를 기반으로 웹 검색을 해야 한다.",
            "web_search",
            "최근 주목받는 AI 스타트업 사례와 서비스 특징"
        ),
    ]

    for hb, uq, th, ac, ai in web_cases:
        samples.append(make_sample(hb, uq, th, ac, ai))

    # -----------------------------
    # B. doc_search 샘플들 (약 20개)
    #  - 개념/원리/비교/정의 → doc_search 로 보내는 패턴
    # -----------------------------
    doc_cases = [
        (
            "없음",
            "강화학습이 뭐야? 직관적으로 설명해줘",
            "강화학습은 내부 문서에 잘 정리된 핵심 개념이므로 doc_search 로 조회하는 것이 알맞다.",
            "doc_search",
            "강화학습의 정의와 직관적인 예시 설명"
        ),
        (
            "없음",
            "자연어 처리가 정확히 뭐야?",
            "자연어 처리는 기본적인 AI 개념으로 내부 문서에 정리되어 있으니 doc_search 를 사용하는 것이 좋다.",
            "doc_search",
            "자연어 처리의 개념, 예시, 활용 사례"
        ),
        (
            "없음",
            "지도학습과 비지도학습의 차이를 알고 싶어",
            "지도/비지도 학습 차이는 정형화된 이론 개념이므로 내부 문서 검색이 적합하다.",
            "doc_search",
            "지도학습과 비지도학습의 차이와 예시"
        ),
        (
            "없음",
            "딥러닝이 머신러닝과 어떻게 다른지 설명해줘",
            "머신러닝/딥러닝 관계는 AI 기본 개념에 속하므로 doc_search 로 정리된 내용을 찾아야 한다.",
            "doc_search",
            "머신러닝과 딥러닝의 관계 및 차이점"
        ),
        (
            "없음",
            "Embedding 이라는게 정확히 뭐야?",
            "Embedding 개념은 내부 문서에서 일관되게 설명된 내용이므로 doc_search 로 검색하는 것이 좋다.",
            "doc_search",
            "임베딩(Embedding)의 정의와 직관적인 설명"
        ),
        (
            "없음",
            "Attention 메커니즘이 왜 중요한지 알려줘",
            "Attention 메커니즘은 이론적으로 복잡하지만 문서화가 잘 되어 있어 doc_search 가 적합하다.",
            "doc_search",
            "Attention 메커니즘의 개념과 중요한 이유"
        ),
        (
            "없음",
            "Transformer 구조를 간단히 설명해줘",
            "Transformer 구조는 내부 문서에 정리된 주요 딥러닝 아키텍처이므로 doc_search 를 사용한다.",
            "doc_search",
            "Transformer 구조와 기본 동작 원리 요약"
        ),
        (
            "없음",
            "벡터 검색이 뭔지 이해가 안 돼. 설명해줘",
            "벡터 검색은 RAG 관련 핵심 개념으로, 내부 문서에 요약되어 있으므로 doc_search 를 쓴다.",
            "doc_search",
            "벡터 검색의 정의와 직관적인 예시"
        ),
        (
            "없음",
            "온톨로지라는 개념이 뭐야?",
            "온톨로지는 지식 표현 관련 이론 개념이므로 doc_search 로 정의를 찾는 것이 좋다.",
            "doc_search",
            "온톨로지의 정의와 활용 예시"
        ),
        (
            "없음",
            "RAG가 뭐고 어떤 구조인지 설명해줘",
            "RAG는 문서 검색과 생성 모델을 결합한 구조로, 내부 문서에 설명이 정리되어 있다.",
            "doc_search",
            "RAG(Retrieval-Augmented Generation)의 개념과 구조"
        ),
        (
            "없음",
            "에이전트라는 개념이 정확히 어떤 의미야?",
            "에이전트 개념은 AI 시스템 구조 설명에 포함되므로 내부 문서를 검색하는 것이 좋다.",
            "doc_search",
            "AI 에이전트의 정의와 역할"
        ),
        (
            "없음",
            "온-폴리시와 오프-폴리시 강화학습 차이를 알려줘",
            "온-폴리시/오프-폴리시 구분은 강화학습 이론 개념이므로 doc_search 가 적절하다.",
            "doc_search",
            "온-폴리시와 오프-폴리시 강화학습의 차이"
        ),
        (
            "없음",
            "LLM이 문장을 생성하는 원리를 설명해줘",
            "LLM 생성 원리는 모델 구조와 토큰 예측 개념으로 정리되어 있으니 doc_search 를 사용해야 한다.",
            "doc_search",
            "LLM이 다음 토큰을 예측하여 문장을 생성하는 원리"
        ),
        (
            "없음",
            "정규화(Normalization)가 왜 필요한지 설명해줘",
            "정규화는 머신러닝 전처리 기본 개념이므로 내부 문서에서 찾는 것이 좋다.",
            "doc_search",
            "데이터 정규화의 필요성과 효과"
        ),
        (
            "없음",
            "오버피팅과 언더피팅이 뭔지 알려줘",
            "오버피팅/언더피팅은 모델 학습의 전형적인 개념이므로 doc_search 로 잘 정리된 설명을 찾는다.",
            "doc_search",
            "오버피팅과 언더피팅의 정의와 예시"
        ),
        (
            "없음",
            "손실 함수가 어떤 역할을 하는지 이해가 안 돼",
            "손실 함수는 모델 최적화의 핵심 개념이라 내부 문서에 정리되어 있을 가능성이 크다.",
            "doc_search",
            "손실 함수의 역할과 직관적인 설명"
        ),
        (
            "없음",
            "배치 정규화(BatchNorm)가 뭔지 설명해줘",
            "배치 정규화는 딥러닝에서 자주 쓰이는 테크닉으로 문서화가 잘 되어 있어 doc_search 를 사용한다.",
            "doc_search",
            "배치 정규화의 개념과 효과"
        ),
        (
            "없음",
            "샘플 수가 적을 때 주의해야 할 점을 알려줘",
            "데이터 수와 일반화 이슈는 이론적으로 정리된 내용이므로 doc_search 가 적절하다.",
            "doc_search",
            "데이터가 적을 때 모델 학습 시 주의해야 할 점"
        ),
        (
            "없음",
            "토큰화 방식에 따라 모델이 어떻게 달라지는지 설명해줘",
            "토큰화 방식과 모델 성능 관계는 내부 문서에서 체계적으로 설명되므로 doc_search 로 검색한다.",
            "doc_search",
            "토큰화 방식에 따른 LLM 특성과 차이"
        ),
        (
            "없음",
            "GPU와 TPU 차이를 간단히 설명해줘",
            "GPU/TPU 차이는 정리된 하드웨어 개념이므로 doc_search 로 정리된 내용을 찾는 것이 좋다.",
            "doc_search",
            "GPU와 TPU의 차이와 장단점"
        ),
    ]

    for hb, uq, th, ac, ai in doc_cases:
        samples.append(make_sample(hb, uq, th, ac, ai))

    # -----------------------------
    # C. summarize 샘플들 (약 20개)
    #  - history_block 에 이미 [web_search 결과] 또는 [doc_search 결과] 가 있음
    #  - Action: summarize
    # -----------------------------
    summarize_cases = []

    # 1) 자율주행 웹검색 결과 요약
    hb1 = """[web_search 결과]
[1] 2025년 8월, 테슬라 최신 혁신 동향 및 산업 OS 변화 ...
[2] 2025 자율주행 기술 동향 및 시장분석 ...
[3] 2025 년 국내외 자율주행차 기술, 시장 전망과 사업화 전략 ..."""
    summarize_cases.append(
        (
            hb1,
            "위 검색 결과를 바탕으로 2025년 자율주행 자동차 기술 동향을 한 번에 정리해줘",
            "웹 검색을 통해 충분한 자료를 얻었으므로, 이제 핵심 내용을 요약해서 사용자에게 전달하는 것이 적절하다.",
            "summarize",
            "2025년 자율주행 자동차 기술 및 시장 동향을 간단히 요약"
        )
    )

    # 2) AI 산업 동향 요약
    hb2 = """[web_search 결과]
[1] 2025년 글로벌 AI 투자 규모 및 주요 분야 ...
[2] 생성형 AI 서비스 상용화 사례 ...
[3] 각국 정부의 AI 규제 및 윤리 가이드라인 ..."""
    summarize_cases.append(
        (
            hb2,
            "위 자료들을 종합해서 2025년 AI 산업의 큰 흐름을 정리해줘",
            "이미 다양한 관점의 기사들이 수집되었으므로, 공통된 흐름과 핵심 포인트를 요약해야 한다.",
            "summarize",
            "2025년 글로벌 AI 산업의 핵심 흐름과 특징 요약"
        )
    )

    # 3) 클라우드 시장 요약
    hb3 = """[web_search 결과]
[1] 2025년 클라우드 시장 점유율 리포트 ...
[2] 주요 CSP(클라우드 서비스 제공자) 비교 기사 ...
[3] 하이브리드/멀티클라우드 전략 관련 분석 ..."""
    summarize_cases.append(
        (
            hb3,
            "이 검색 결과를 기반으로 2025년 클라우드 시장의 특징을 요약해줘",
            "클라우드 시장 관련 데이터가 충분히 모였으므로, 공통된 특징만 추려서 요약하는 것이 좋다.",
            "summarize",
            "2025년 클라우드 시장의 주요 특징과 트렌드 요약"
        )
    )

    # 4) LLM 보안 이슈 요약
    hb4 = """[web_search 결과]
[1] 프롬프트 인젝션 공격 사례 ...
[2] 모델 유출 및 데이터 유출 사고 ...
[3] 기업 환경에서의 LLM 보안 가이드라인 ..."""
    summarize_cases.append(
        (
            hb4,
            "위 자료들을 바탕으로 LLM 보안 이슈의 핵심을 정리해줘",
            "여러 보안 사건과 가이드라인이 모였으므로, 공통된 위험 요소와 대응 방법을 요약할 필요가 있다.",
            "summarize",
            "LLM 보안 이슈 핵심 위험 요소와 대응 방법 요약"
        )
    )

    # 5) 원격 근무 트렌드 요약
    hb5 = """[web_search 결과]
[1] 2025년 원격 근무 도입 기업 비율 통계 ...
[2] 하이브리드 근무제 사례 ...
[3] 원격 근무가 생산성과 워라밸에 미치는 영향 분석 ..."""
    summarize_cases.append(
        (
            hb5,
            "위 검색 결과를 한 번에 요약해서 2025년 원격 근무 트렌드를 설명해줘",
            "관련 통계와 사례가 충분히 모였으므로, 핵심 키워드 중심으로 정리해야 한다.",
            "summarize",
            "2025년 원격 근무 트렌드와 장단점 요약"
        )
    )

    # 나머지 15개는 패턴만 다르게 하여 추가 생성
    extra_summaries = [
        "데이터센터 전력 사용 이슈",
        "생성형 AI 규제 논의",
        "챗봇 상용화 사례",
        "스타트업 투자 동향",
        "GPU 수급 상황",
        "클라우드 자격증 수요",
        "AI 윤리 가이드라인",
        "머신러닝 프레임워크 인기",
        "데이터 분석 직무 변화",
        "AI 스타트업 성공 사례",
        "국내 AI 정책 로드맵",
        "글로벌 LLM 경쟁 구도",
        "반도체 시장 전망",
        "모바일 AI 칩 동향",
        "로봇 공학과 AI 융합 사례",
    ]

    for topic in extra_summaries:
        hb = f"""[web_search 결과]
[1] {topic} 관련 최신 리포트 ...
[2] {topic} 를 다루는 분석 기사 ...
[3] {topic} 에 대한 인터뷰 및 전문가 의견 ..."""
        uq = f"위 검색 결과를 기준으로 {topic} 에 대해 한 번에 이해할 수 있게 요약해줘"
        th = "여러 문서에서 공통적으로 언급되는 내용을 중심으로 핵심만 요약하는 것이 좋다."
        ac = "summarize"
        ai = f"{topic} 에 대한 핵심 내용 요약"
        summarize_cases.append((hb, uq, th, ac, ai))

    for hb, uq, th, ac, ai in summarize_cases:
        samples.append(make_sample(hb, uq, th, ac, ai))

    # -----------------------------
    # D. FINAL 샘플들 (약 20개)
    #  - 도구 없이 바로 답변하는 경우
    # -----------------------------
    final_cases = [
        (
            "없음",
            "너는 어떤 역할을 하는 에이전트야?",
            "이 질문은 내 시스템 역할에 대한 설명만 하면 되므로 도구 없이 바로 답변할 수 있다.",
            "FINAL",
            "나는 한국어로 대화하면서 web_search, doc_search, summarize 같은 도구를 활용해 정보를 찾아주고 정리해 주는 지능형 에이전트야."
        ),
        (
            "없음",
            "간단하게 인사만 해줘",
            "단순 인사 요청이므로 별도의 도구가 필요 없다.",
            "FINAL",
            "안녕하세요! 저는 여러 도구를 활용해서 정보를 찾아주고 정리해 주는 한국어 지능형 에이전트입니다. 편하게 질문해 주세요."
        ),
        (
            "없음",
            "너와 대화할 때 어떤 식으로 질문하면 좋아?",
            "질문 방식에 대한 안내는 내부 규칙만 설명하면 되므로 도구가 필요 없다.",
            "FINAL",
            "원하는 내용을 최대한 구체적으로 적어주면 좋아. 예를 들어 '개념 설명', '코드 예시', '단계별 절차'처럼 형식을 지정해 주면 더 정확하게 도와줄 수 있어."
        ),
        (
            "없음",
            "도구를 언제 사용하는지 기준을 알려줘",
            "내가 도구를 사용하는 기준은 시스템 프롬프트만으로 충분히 설명할 수 있다.",
            "FINAL",
            "최신 정보나 통계가 필요하면 web_search, AI 개념이나 이론은 doc_search, 여러 결과를 한 번에 정리할 땐 summarize 를 사용해. 그 외에는 바로 답변하는 방식으로 동작해."
        ),
        (
            "없음",
            "오늘 기분 어때?",
            "단순한 감정 표현 요청이므로 도구 없이 답변하면 된다.",
            "FINAL",
            "나는 감정을 느끼지는 않지만, 항상 네가 궁금한 것을 해결해 주기 위해 준비된 상태야!"
        ),
        (
            "없음",
            "농담 하나 해줘",
            "간단한 농담은 도구가 필요 없다.",
            "FINAL",
            "프로그래머가 웃을 때 뭐라고 하는지 알아? 하하하가 아니라 'ㅋㅋ 디버그 끝났다...'"
        ),
        (
            "없음",
            "너의 강점을 한 줄로 말해줘",
            "자기 소개성 질문이므로 도구 없이 바로 대답할 수 있다.",
            "FINAL",
            "복잡한 기술 내용도 단계별로 풀어서 설명해 줄 수 있는 점이 나의 가장 큰 강점이야."
        ),
        (
            "없음",
            "도구를 전혀 쓰지 말고 간단한 자기소개만 해줘",
            "도구 없이 자기소개만 하면 된다는 조건이므로 FINAL을 선택하는 것이 맞다.",
            "FINAL",
            "나는 한국어로 대화하면서, 필요할 때만 웹검색이나 내부 문서를 활용해 정보를 찾아주는 LLM 기반 에이전트야."
        ),
        (
            "없음",
            "앞으로 대화할 때 널 어떻게 부르면 될까?",
            "호칭에 대한 간단한 답변이므로 도구를 쓸 필요가 없다.",
            "FINAL",
            "편하게 '에이전트' 또는 '어시스턴트'라고 불러줘도 좋아."
        ),
        (
            "없음",
            "고마워 라고 대신 말해줘",
            "단순한 문장 요청이므로 도구 없이도 충분하다.",
            "FINAL",
            "정말 고마워! 네 덕분에 일이 훨씬 잘 풀리고 있어."
        ),
        (
            "없음",
            "내가 지금까지 한 질문들에 대해 한 줄로 요약해줄 수 있어?",
            "이 경우에는 대화 내용이 내부에 있다고 가정하고, 도구 없이 간단히 요약할 수 있다.",
            "FINAL",
            "지금까지 너는 AI, 에이전트 동작 방식, ReAct 구조, 그리고 모델 튜닝 방법에 대해 차근차근 확인하고 있었어."
        ),
        (
            "없음",
            "너는 스스로 결정을 내릴 수 있어?",
            "에이전트의 동작 원리에 대한 설명이므로 도구가 필요 없다.",
            "FINAL",
            "나는 스스로 결정을 내린다기보다는, 미리 정의된 규칙과 학습된 패턴을 바탕으로 최적의 액션을 선택하는 방식으로 동작해."
        ),
        (
            "없음",
            "ReAct 구조를 간단히 한 줄로 설명해줘",
            "ReAct 는 이미 내부 개념으로 정리되어 있다고 보고, 짧게 정의만 알려주면 된다.",
            "FINAL",
            "ReAct는 '생각(Reasoning)'과 '행동(Action)'을 번갈아 수행하면서 도구를 활용해 문제를 해결하는 프롬프트 전략이야."
        ),
        (
            "없음",
            "이 대화의 목적을 한 줄로 요약해줘",
            "현재 대화의 메타 목적을 설명하는 것이므로 도구가 필요 없다.",
            "FINAL",
            "이 대화의 목적은 LLaMA 기반 모델이 ReAct 형식에 맞춰 안정적으로 도구를 선택하도록 학습시키는 거야."
        ),
        (
            "없음",
            "나에게 한 마디 응원의 말을 해줘",
            "단순 응원 메시지는 도구 없이 바로 생성 가능하다.",
            "FINAL",
            "지금처럼 하나씩 차근차근 정리해 나가면 분명히 실무에서도 큰 강점이 될 거야. 계속 가보자!"
        ),
        (
            "없음",
            "네가 볼 때 나는 어떤 타입의 개발자 같아?",
            "이 질문은 지금까지의 맥락에 기반한 추측이므로 도구 없이 답변하면 된다.",
            "FINAL",
            "계획을 세우고 실험을 통해 검증하면서, 끝까지 파고드는 타입의 개발자에 가깝다고 느껴져."
        ),
        (
            "없음",
            "ReAct 튜닝을 하면서 가장 중요한 포인트 한 가지만 말해줘",
            "핵심 포인트 하나만 말해 달라는 요청이므로 도구는 필요 없다.",
            "FINAL",
            "모델이 항상 같은 포맷(Thought / Action / Action Input)을 지키도록 충분하고 다양한 예시를 제공하는 것이 가장 중요해."
        ),
        (
            "없음",
            "tool을 잘 쓰는 에이전트를 만들고 싶을 때 어떤 데이터를 모아야 하는지 한 줄로 말해줘",
            "데이터 설계에 대한 조언이므로 바로 답변할 수 있다.",
            "FINAL",
            "각 도구를 언제 쓰는지 분명한 기준이 드러나도록, 다양한 상황에서의 질문-생각-도구선택-입력 패턴을 예시로 만들어야 해."
        ),
        (
            "없음",
            "지금까지 설명해줘서 고마워",
            "감사 인사에 대한 짧은 응답이므로 도구 없이 처리하면 된다.",
            "FINAL",
            "나도 함께 정리할 수 있어서 좋아. 계속 같이 만들어 보자!"
        ),
        (
            "없음",
            "앞으로도 이렇게 단계별로 도와줄 수 있어?",
            "역할에 대한 약속을 표현하는 것이므로 도구가 필요 없다.",
            "FINAL",
            "그럼! 앞으로도 환경 설정부터 모델 튜닝, 에이전트 설계까지 단계별로 같이 정리해 줄게."
        ),
    ]

    for hb, uq, th, ac, ai in final_cases:
        samples.append(make_sample(hb, uq, th, ac, ai))

    return samples


# ---------------------------------------------------------
# 4) JSONL 저장
# ---------------------------------------------------------

def save_jsonl(samples, path: Path):
    with path.open("w", encoding="utf-8") as f:
        for sample in samples:
            line = json.dumps(sample, ensure_ascii=False)
            f.write(line + "\n")


if __name__ == "__main__":
    out_path = Path("react_sft_data.jsonl")
    data = build_dataset()
    save_jsonl(data, out_path)
    print(f"✅ {len(data)}개 샘플을 {out_path} 에 저장했습니다.")
